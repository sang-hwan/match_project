### 현황 및 목적

현재 진행 중인 파이프라인(2 → 3 → 4번 스크립트)은 "625개의 HWP 추출 이미지와 233개의 원본 이미지"를 정확히 100% 1:1 매핑하는 것을 목표로 하고 있습니다.

---

### 현행 파이프라인 설명

#### 1. 전처리 (2번 스크립트)

* **이미지 크기 및 종횡비 정규화**

  * 모든 이미지를 긴 변(long side)을 기준으로 같은 픽셀 크기(`--size`)로 통일합니다.

* **색상 및 명도 채널 분리**

  * 컬러 채널(원본 색 정보)과 그레이 채널(조명 및 형태 정보)로 구분하여 처리합니다.

* **엣지 아티팩트 최소화**

  * `replicate` 패딩을 적용하여 경계 왜곡을 억제합니다.
  * `constant` 패딩을 활용하여 배경을 명확히 구분합니다.

* **이미지 경로 매핑**

  * 전처리 전후의 이미지 경로를 JSON으로 저장합니다.

#### 2. 매핑 후보군 선정 (3번 스크립트)

* **그레이 이미지**는 `pHash` 알고리즘을 사용해 후보군을 추출합니다.
* **컬러 이미지**는 히스토그램(Hist)을 사용하여 별도의 후보군을 추출합니다.

#### 3. 정밀 1:1 매핑 (4번 스크립트)

* 앞서 추출한 후보군을 대상으로 **전처리 이전의 원본 이미지**를 이용하여 `SIFT + RANSAC` 알고리즘으로 정밀하게 최종 매핑을 수행합니다.

---

### 프로세스 진행에 대한 질문 및 의문

현재 파이프라인에 대해 다음과 같은 의문과 질문이 있습니다.

1. **알고리즘 선정에 대한 타당성**

   * 이미지 매핑 알고리즘으로 pHash, Hist, SIFT+RANSAC 외에도 ORB+RANSAC, dHash, aHash 등 여러 옵션이 있습니다. 현재와 같이 후보군을 pHash와 Hist로 좁힌 후 SIFT+RANSAC으로 매핑하는 과정이 과연 최적인지, 타당한 이유가 있는지 명확하지 않아 이 부분에 대한 설명이 필요합니다.

2. **현재 전처리 과정의 충분성**

   * 현 전처리 과정이 목적 달성에 충분한지, 추가적인 전처리나 다른 전처리 방법이 필요한지 확인이 필요합니다.

3. **정밀 매핑 단계에서의 이미지 사용 여부**

   * 정밀 매핑(SIFT+RANSAC)을 전처리 이전의 원본 이미지를 사용하는 것이 맞는지, 아니면 전처리된 이미지를 사용하는 것이 더 정확한 결과를 얻을 수 있는지에 대한 판단과 그 이유를 알고 싶습니다.

---

### 목적에 적합한 프로세스 추천 요청

위와 같은 상황을 고려하여, 현재의 "625개 추출 이미지와 233개 원본 이미지의 정확한 1:1 매핑"이라는 목적에 가장 적합한 프로세스를 추천해 주세요. 추천하시는 프로세스가 현행 파이프라인과 다르다면, 변경을 권장하는 이유와 그 근거도 함께 설명해 주시기를 바랍니다.

---

### 기타 프로세스(육안 검증 및 이미지 교체)

* `5_check_map_result.py`(육안 검증)와 `6_replace_stream.py`(이미지 교체)는 최종 매핑 결과에 따라 유연하게 조정 가능합니다. 이는 메인 프로세스가 변경될 경우 적절히 수정하면 됩니다.
